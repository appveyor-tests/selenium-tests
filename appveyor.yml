#os: test
#os: Visual Studio 2015

#install:
#- ps: $blockRdp = $true; iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))

init:
- appveyor version

install:
- ps: |
    Write-Host "Installing Chrome Selenium driver..." -ForegroundColor Cyan

    $zipPath = "$env:TEMP\chromedriver_win32.zip"
    (New-Object Net.WebClient).DownloadFile('https://chromedriver.storage.googleapis.com/114.0.5735.90/chromedriver_win32.zip', $zipPath)
    7z x $zipPath -aoa -o"$destPath"
    Remove-Item $zipPath
    Write-Host "Installed Chrome Selenium driver" -ForegroundColor Green 
     
#- ps: iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-desktop.ps1'))
- ps: iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/set-screenresolution.ps1'))
- ps: Set-ScreenResolution 1600 1200
#- ps: .\update-drivers.ps1

before_build:
  - nuget restore

after_test:
  - ps: .\take-screenshot.ps1

on_finish:
  - ps: Get-ChildItem .\*.png -Recurse | % { Push-AppveyorArtifact $_.FullName -FileName $_.Name }

on_failure:
- 
